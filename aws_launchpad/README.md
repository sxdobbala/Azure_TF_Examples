# AWS Launchpad 

## What is it?

Launchpad is the audit-only security and compliance baseline that is being applied to all accounts (AWS) and subscriptions (Azure) in the Public Cloud. The first release provides initial visibility into account compliance by forwarding logs of policy violations to central logging systems. You as an owner of the account are required to triage and remediate any issues that Launchpad reveals.Â Launchpad will not correct identified security issues.

## Why do I need it?

Launchpad is necessary for all AWS and Azure accounts as it provides Enterprise Information Security a way to monitor the security of public cloud accounts. This is not intended to punish users for any identified security violations, but rather help remediate risks and validate that Optum Security Standards are being met. 

Please visit [Public Cloud Security Controls](https://www.optumdeveloper.com/content/odv-optumdev/optum-developer/en/developer-centers/hosting/public-cloud/public-cloud-security-principles.html) on Optum Developer to learn more about securing public cloud accounts. 

## How does it work?

AWS Launchpad works by configuring the [CloudTrail](https://aws.amazon.com/cloudtrail/) and [Config](https://aws.amazon.com/config/) services in us-east-1 region to send logs to S3 buckets in a Central Management Account. AWS Config includes the following components: Config Recorder, Config Delivery Channel, and numerous Config Rules. The logs are then forwarded to Splunk for Enterprise Information Security monitoring.  In addition to the CloudTrail and Config components AWS Launchpad, upon initial account provisioning, removes the default VPCs in all AWS regions order to remove any Optum non-standard configurations regarding security.

In addition to above process, now AWS Launchpad also works by configuring the [CloudTrail](https://aws.amazon.com/cloudtrail/) and [VPC](https://aws.amazon.com/vpc/) services(if created) in us-east-1 region to send logs to Cloudwatch Log Group.Log data is stored in encrypted format throughout its retention period in log group,using an AWS Key Management Service (AWS KMS) customer master key (CMK) which is created in Customers Account through launchpad. From Cloudwatch Log Group, the logs are aggregated and flown to log destnation in a Central Management Account through subscription filter.  On the side of Central Management Account (Receiving account), the destination is configured to recieve logs from multiple sender accounts. 

The destination is then configured with the Kinesis Firehose.Destination will push the log data from multiple accounts into the Data stream and Kinesis Firehose pulls log data from data stream which is encrypted using default Kinesis service master key, this is the KMS master key generated by the Kinesis service.Firehose is configured with destination (in this case Splunk ) and a S3 bucket to store all logs. Finally, Log data from the sender account is then streamed to Splunk via Kinesis Firehose for Enterprise Information Security monitoring. In addition to above process, a Lambda function is triggered when Firehose puts any logs inside the S3 bucket.This lambda function will process the logs and store them inside a separate S3 bucket in the format of **"Account-Owner-Id"/"Log-Group-Type"/"Logs-File(Everyday)"**. In addition, an SQS is used as dead letter queue for this Lamdba to store processing failure events. This SQS is encrypted using AWS Managed Key.


No action is required on the user's end to run AWS Launchpad. This is done automatically by using a master account to assume the `OrganizationAccountAccessRole` that is under all of the underlying accounts. The `OrganizationAccountAccessRole` has `AdminstratorAccess` and its only Trusted Entity is the respective Master account. 

 [Learn more about the Config module used in AWS Launchpad](https://github.optum.com/CommercialCloud-EAC/aws_config).

 > Note: Launchpad controls the AWS_config service within an account, preventing users from adding their own rules or recorder. Additionally, our AWS Config resources (Config Recorder, Config Delivery Channel, and Config Rules) may not be applied completely if there's an existing Recorder and/or Delivery Channel. This functionality will be improved in a future release.

# Launchpad Structure

## central_management_account

Updates the provided Central Managment Account's Bucket Policies for Launchpad (CloudWatch, Config, Backend) and uploads the Lambda Function zip files used in the Central Management and Master accounts.

Inspiration for this method of updating the S3 Bucket Policy can be found [here](https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudtrail-receive-logs-from-multiple-accounts.html).

Creates a Lambda Function to be used to audit resources in an AWS Account under the Master. An SNS Topic is created to allow Launchpad Lambda Functions from the Master and Central Management Account to publish to. 

## central_eis_account

Applies/Updates the __EISRead__ and __EISBreakGlass__ roles under the Central EIS Security Account. Please see the [EIS Access markdown](EIS_Access.md) for more details.

## master_account

Applies a Lambda Function in the Master Account to invoke Lambda Functions within the Central Management Account for asynchronous auditing of resources in an AWS Account under the Master. A CloudWatch Event Scheduler is in place to run this Lambda Function in 1 hour increments. 

## launchpad_account

Applies/Updates Launchpad on the provided Customer's Account (CloudWatch, Config, Cloudtrail) and the __Read__ and __BreakGlass__ roles under each Launchpad account. Please see the [EIS Access markdown](EIS_Access.md) for more details. 

If __Enterprise__ level of __AWS Support__ is not enabled in the account, Launchpad will also create a __Support Case__ on behalf of the account through the respective AWS Master. For more details, see the [Python script](launchpad_account/enable_support.py) that creates the __Support Case__.

## version.txt

This text file contains a string that will determine the version tag that should be created when running a full Launchpad run (all accounts in the yaml file) on the set of production accounts (Enterprise). If the tag exists, no tag will be created.

Version must be in the format of: ```vX.Y.Z[alpha|beta]```, where ```X```, ```Y```, ```Z``` are numbers and ```alpha``` or ```beta``` may be appended.

version.txt example
```
v1.5.0
```

## Configuration

* The `AWSRefreshAccountList.yml` contains all the configurations needed with the Pipeline and the Terraform projects and is 
located in a separate private repo aws_launchpad_refresh.
* The YAML file gets updated from the AWS onboarding and creation process. The section of the 
file that gets updated (POC or Enterprise) is determined by the Service Now provisioning functionality
and subsequently passed on to the provisioning process. Upon updating the account to get processed
will get placed in the the GitHub commit message where the Jenkins pipeline will pick it up for 
subsequent single account processing.

```yml
POC: # Environment Type
  credentialsKey: 'MASTERADMINKEY' # Jenkins Credentials for AWS Key
  credentialsSecret: 'MASTERADMINSECRET' # Jenkins Credentials for AWS Secret
  accountsInfo: # Account Block
    central: "304095320850" # The Central Account that will contain the central CloudTrail, CloudWatch, Config, and Backend S3 Buckets (central_management_account)
    securityCentral: "614817484114" # The Central EIS Security Account that will contain the EISRead and EISBreakGlass roles utilized by EIS Users
    customers: # The Accounts to apply Launchpad and log to the respective Central Account Buckets (launchpad_account)
      test:     # "Account Category" and allows for different accounts for different test phases
        prompt: false     # Used in the pipeline to determine if prompting should be done for the 
        accounts:
        - "111111111111"
        - "222222222222"
        - "333333333333"  
Enterprise: # Multiple Environment Types can be set
  prompt: true # Indicator for the Jenkins pipe line to prompt approval before continuing             Enterprise accounts
  credentialsKey: 'ENTERPRISEMASTERADMINKEY'
  credentialsSecret: 'ENTERPRISEMASTERADMINSECRET'
  accountsInfo:
      central: "626017279283"
      securityCentral: "494528487614"
      customers:
        prod:               # "Account Category" 
          prompt: true      # Used in the pipeline to determine if prompting should be done for the 
          accounts:
          - "444444444444" 
          - "555555555555"
          - "666666666666"    
```

* Enterprise Central Management Account: __626017279283__
* Enterprise Central Management CloudTrail Bucket: __cloudtrail-626017279283-logg-rcloudtrailbucket__
* Enterprise Central Management Config Bucket: __cc-cfg-central-626017279283__
* Enterprise Central Management Launchpad Backend Bucket: __launchpad-tfstate-626017279283__
* Enterprise Central Management Central Logging Backend: __626017279283-tfstate-central-logging__
* Enterprise Central Management CloudWatch Bucket: __cloudwatch-securityaccount-logg-rcloudwatchbucket-4dlk3440lkdjh__
* POC Central Management Account: __304095320850__
* POC Central Management CloudTrail Bucket: __cloudtrail-304095320850-logg-rcloudtrailbucket__
* POC Central Management Config Bucket: __cc-cfg-central-304095320850__
* POC Central Management Launchpad Backend Bucket: __launchpad-tfstate-304095320850__
* POC Central Management Central Logging Backend: __304095320850-tfstate-central-logging__
* EIS POC Security Access Account: __614817484114__
* EIS Enterprise Security Access Account: __494528487614__

# Running

**NOT RUN BY INDIVIDUALS/USERS**

AWS Launchpad will be ran against all existing AWS Accounts and new AWS Accounts during provisioning. No action is required to run this by Users and Owners of said AWS Accounts.

## Failures

Below are possible cases that will fail the __aws_launchpad__ Jenkins build or the application of Launchpad's Terraform files or features on an AWS Account. 

### No OrganizationAccountAccessRole 

AWS Account does not have the IAM Role __OrganizationAccountAccessRole__ created during the Account Provisioning process. This is an unlikely scenario if the account was created through our Intake Process but in the likely hood that the account was created elsewhere (ex. an aquired or transferred account), we will not be able to access the account. 

### Pre-Existing AWS Config and CloudTrail

If __AWS Config__ has already been configured within the account, Launchpad's Config setup will not be able to be fully applied depending on the existing resources. For full Launchpad Config setup (only in us-east-1 right now), we need no __AWS Configuration Recorder__, no __AWS Config Delivery Channel__, and no __AWS Config Rules__. The __AWS Configuration Recorder__ and __AWS Config Delivery Channel__ can only be removed through the AWS API (CLI, Boto3, etc.), while the __AWS Config Rules__ can be deleted through the console or API. Each of these resources need to be deleted individually, deleting one will not delete the others.

If __AWS CloudTrail__ already hit the default limit of 5 Trails within the account, Launchpad's CloudTrail will not be able to be applied. 

If any of the above fail, the Launchpad build will continue and will log the accounts that were unsuccessful in getting Launchpad fully applied.

### Drifting Between Launchpad Resources and the State File

If an existing account that has had Launchpad previously applied to and the account has modified/deleted a resource created by Launchpad, there may be a failure with reapplying Launchpad's Terraform resources. This is mostly caused by a drift between the Terraform State File (located in the Central Management Account) and the actual Terraform resources applied by Launchpad in the account during the reapplication. Terraform will in most cases, be able to detect the drifts and resolve them by automatically adding the now modified/deleted resources into the Terraform Plan and continue to the Terraform Apply stage. 

An example of a case where the Terraform Plan wasn't able to detect a drift was when an account deleted its Launchpad Config resources and since one of our ```launchpad_account``` Terraform outputs requires the count of all of the Config Rules, it failed during the Terraform Plan's Refresh stage. At the time, we had to resolve this issue manually by removing the deleted resources from the State File and then reapply Launchpad to the account.

If any of the above fail, the Launchpad build will continue and will log the accounts that were unsuccessful in getting Launchpad fully applied.

### Applying Previous Release/Tags of Launchpad

If using version ```v1.6.0+```'s pipeline of ```aws_launchpad``` to apply an earlier release/tag of Launchpad in a Single Account run (ex. Jenkins building from ```v1.6.0``` pipeline and using ```v1.4.2``` codebase to apply Launchpad, building from ```v1.6.0``` commit), there will be a failure in the build due to the breaking change in the separation of the __AWSAdapter__ class from the _Jenkinsfile_ to the _AWSAdapter.groovy_ file. Earlier versions have the __AWSAdapter__ class defined in the Jenkinsfile, which is not supported with newer pipelines.

If running a previous version of a Launchpad Build in Jenkins with its repsective pipeline (ex. Jenkins building from the ```v1.4.2``` pipeline and using ```v1.4.2``` source code, building from ```v1.4.2``` commit) will work as long as the BaseLaunchpadPipeline doesn't have any breaking changes.

# Tooling

* [Install Terraform](https://www.terraform.io/intro/getting-started/install.html)
* [Install AWS CLI](https://docs.aws.amazon.com/cli/latest/userguide/installing.html)

Please see the [aws_bootstrap repository](https://github.optum.com/CommercialCloud-EAC/aws_bootstrap) to get an understanding of the module, along with the [prepare and init bash scripts](https://github.optum.com/CommercialCloud-EAC/aws_bootstrap/tree/master/scripts).

# Testing considerations

## cleanse_lauchpad.sh

This script will blindly destroy all resources that central_management_account, central_eis_account, and aws_launchpad could create. This is done for testing purposes. If you have a failure that leaves terraform in an indeterminate state we want to be able to purge the resources and get back to a known good state. This is implemented within the jenkins pipeline directly today.

cleanse_launchpad.sh requires a single argument that would be the 12 digit AWS Account ID that you would like to "cleanse". Example below.

```sh -x ./cleanse_launchpad.sh 1234567891012```

# EIS Related Documents

* [EIS Access](EIS_Access.md) : Markdown describing the EIS Roles and uses in the Central EIS Security Accounts.
* [Switch Role in AWS](SwitchRoleAWS.md) : Markdown guide on how to switch roles inside the Central EIS Security Accounts.

## Config Rules
Below is a list of all the AWS config rules/policies applied via Launchpad and a brief note on thier intent. 

| Unique Name   | Intent of Rule/Why it exists  | Notes                                  |
| -------- | ------------------------------------------------------------ |   ------------------------------------------------------------ |
| AUTOSCALING_GROUP_ELB_HEALTHCHECK_REQUIRED | Checks whether your Auto Scaling groups that are associated with a load balancer are using Elastic Load Balancing health checks | If non-compliance is identified, perform the following... | 
| DESIRED_INSTANCE_TENANCY | Checks instances for specified tenancy. Specify AMI IDs to check instances that are launched from those AMIs or specify Host IDs to check whether instances are launched on those Dedicated Hosts. Separate multiple ID values with commas | |
| EC2_INSTANCE_DETAILED_MONITORING_ENABLED | Checks whether detailed monitoring is enabled for EC2 instances | . |
| INSTANCES_IN_VPC | Checks whether your EC2 instances belong to a virtual private cloud (VPC). Optionally, you can specify the VPC ID to associate with your instances. | . |  
| EC2_MANAGEDINSTANCE_INVENTORY_BLACKLISTED | Checks whether instances managed by Amazon EC2 Systems Manager are configured to collect blacklisted inventory types | . |  
| EC2_VOLUME_INUSE_CHECK | Checks whether EBS volumes are attached to EC2 instances. Optionally checks if EBS volumes are marked for deletion when an instance is terminated | . |  
| EIP_ATTACHED | Checks whether all EIP addresses allocated to a VPC are attached to EC2 instances or in-use ENIs. | . |  
| ENCRYPTED_VOLUMES | Checks whether EBS volumes that are in an attached state are encrypted. Optionally, you can specify the ID of a KMS key to use to encrypt the volume | . |  
| ELB_ACM_CERTIFICATE_REQUIRED | This rule checks whether the Elastic Load Balancer(s) uses SSL certificates provided by AWS Certificate Manager. You must use an SSL or HTTPS listener with your Elastic Load Balancer to use this rule | . |  
| ELB_CUSTOM_SECURITY_POLICY_SSL_CHECK | Checks whether your Classic Load Balancer SSL listeners are using a custom policy. The rule is only applicable if there are SSL listeners for the Classic Load Balancer. | . |  
| RESTRICTED_INCOMING_TRAFFIC | Checks whether security groups that are in use disallow unrestricted incoming TCP traffic to the specified ports. | . |  
| INCOMING_SSH_DISABLED | Checks whether security groups that are in use disallow unrestricted incoming SSH traffic | . |  
| DB_INSTANCE_BACKUP_ENABLED | Checks whether RDS DB instances have backups enabled. Optionally, the rule checks the backup retention period and the backup window | . |  
| RDS_STORAGE_ENCRYPTED | Checks whether storage encryption is enabled for your RDS DB instances | . |  
| REDSHIFT_CLUSTER_CONFIGURATION_CHECK | Checks whether Amazon Redshift clusters have the specified settings. | . |  
| REDSHIFT_CLUSTER_MAINTENANCESETTINGS_CHECK | Checks whether Amazon Redshift clusters have the specified maintenance settings. | . |  
| CLOUDWATCH_ALARM_SETTINGS_CHECK | Checks whether CloudWatch alarms with the given metric name have the specified settings. | . |  
| CODEBUILD_PROJECT_ENVVAR_AWSCRED_CHECK | Checks whether the project contains environment variables AWS_ACCESS_KEY_ID and AWS_SECRET_ACCESS_KEY. The rule is NON_COMPLIANT when the project environment variables contains plaintext credentials. | . |  
| CODEBUILD_PROJECT_SOURCE_REPO_URL_CHECK | Checks whether the GitHub or Bitbucket source repository URL contains either personal access tokens or user name and password. The rule is compliant with the usage of OAuth to grant authorization for accessing GitHub or Bitbucket repositories | . |  
| CODEBUILD_PROJECT_ENVVAR_AWSCRED_CHECK | Checks whether the project contains environment variables AWS_ACCESS_KEY_ID and AWS_SECRET_ACCESS_KEY. The rule is NON_COMPLIANT when the project environment variables contains plaintext credentials | . |  
| CODEBUILD_PROJECT_SOURCE_REPO_URL_CHECK | Checks whether the GitHub or Bitbucket source repository URL contains either personal access tokens or user name and password. The rule is compliant with the usage of OAuth to grant authorization for accessing GitHub or Bitbucket repositories | . |  
| IAM_GROUP_HAS_USERS_CHECK | Checks whether IAM groups have at least one IAM user. | . |  
| IAM_USER_GROUP_MEMBERSHIP_CHECK | Checks whether IAM users are members of at least one IAM group | . |  
| IAM_USER_NO_POLICIES_CHECK | Checks that none of your IAM users have policies attached. IAM users must inherit permissions from IAM groups or roles | . |  
| S3_BUCKET_PUBLIC_READ_PROHIBITED | Checks that your S3 buckets do not allow public read access. If an S3 bucket policy or bucket ACL allows public read access, the bucket is noncompliant. | . |  
| S3_BUCKET_PUBLIC_WRITE_PROHIBITED | Checks that your S3 buckets do not allow public write access. If an S3 bucket policy or bucket ACL allows public write access, the bucket is noncompliant | . |  
| S3_BUCKET_SSL_REQUESTS_ONLY | Checks whether S3 buckets have policies that require requests to use Secure Socket Layer (SSL). | . |  
| S3_BUCKET_LOGGING_ENABLED | Checks whether logging is enabled for your S3 buckets. | . |  
| LAMBDA_FUNCTION_PUBLIC_ACCESS_PROHIBITED | Checks whether the Lambda function policy prohibits public access. The rule is NON_COMPLIANT if the Lambda function policy allows public access | . |  
| EC2_MANAGEDINSTANCE_APPLICATIONS_BLACKLISTED | Checks whether instances managed by Amazon EC2 Systems Manager are configured to collect blacklisted inventory types. | . |  
| EC2_MANAGEDINSTANCE_APPLICATIONS_REQUIRED | . | . |  
| CLOUD_TRAIL_ENABLED | Checks whether AWS CloudTrail is enabled in your AWS account. Optionally, you can specify which S3 bucket, SNS topic, and Amazon CloudWatch Logs ARN to use. | . |  
| DYNAMODB_THROUGHPUT_LIMIT_CHECK | Checks whether provisioned DynamoDB throughput is approaching the maximum limit for your account. By default, the rule checks if provisioned throughput exceeds a threshold of 80% of your account limits | . |  
| IAM_PASSWORD_POLICY | Checks whether the account password policy for IAM users meets the specified requirements. | . |  
| ROOT_ACCOUNT_MFA_ENABLED | Checks whether the root user of your AWS account requires multi-factor authentication for console sign-in | . |  
| ACM_CERTIFICATE_EXPIRATION_CHECK | Checks whether ACM Certificates in your account are marked for expiration within the specified number of days. Certificates provided by ACM are automatically renewed. ACM does not automatically renew certificates that you import | . |  
| ATTACHED_INTERNET_GATEWAY_CHECK | Attached Internet Gateway Compliance Rule: Flags VPCs that have an Internet Gateway attached | . |  
| OPEN_SECURITY_GROUP_CHECK | Open Security Group Compliance Rule: Checks if a Security Group has a Cidr of IPv4 0.0.0.0/0 or IPv6 ::/0 | . |  
| ALL_OPEN_INBOUND_PORTS_SECURITY_GROUP_CHECK | Open Inbound Ports Security Group Compliance Rule: Checks if a Security Group has configured too large of range of ports open | . |

# EIS Security Endorsement

-------------------

> **NOTE:** The policies in the following list perform alerting to notify when a non-compliant situation occurs, as opposed to actively preventing the situation from occurring.  Active prevention may be possible using custom policies and will be implemented in a future release.

The [AWS Config](https://github.optum.com/CommercialCloud-EAC/aws_config) module defines the policies applied in AWS Launchpad.

| Req ID   | Requirement                                                  | Related AWS Config Policies                                  |
| -------- | ------------------------------------------------------------ | ------------------------------------------------------------ |
| **2.1**  | _Key Strength_: Cloud native functionality protecting the confidentiality, authenticity and integrity of data must be enabled to encrypt data at rest and in motion. | All encryptable AWS services use the [AES-256 encryption algorithm](https://docs.aws.amazon.com/kms/latest/developerguide/crypto-intro.html). <br /><br />Policies in requirement 2.4 include checking the encryption of EBS volumes, RDS instances, and S3 storage. [Additional information on encrypting AWS services](https://docs.aws.amazon.com/kms/latest/developerguide/service-integration.html) |
| **2.3**  | *Data in Transit*: Cloud native functionality protecting the confidentiality, authenticity and integrity of data in transit must be implemented. | **ELB_ACM_CERTIFICATE_REQUIRED** checks whether the Elastic Load Balancer(s) uses SSL certificates provided by AWS Certificate Manager.<br/>**ACM_CERTIFICATE_EXPIRATION_CHECK** checks whether ACM Certificates in your account are marked for expiration within the specified number of days.<br/>**S3_BUCKET_SSL_REQUESTS_ONLY** checks whether S3 buckets have policies that require requests to use Secure Socket Layer (SSL).<br/> **ELB_CUSTOM_SECURITY_POLICY_SSL_CHECK** checks whether your Classic Load Balancer SSL listeners are using a custom policy. <br/>**ELB_PREDEFINED_SECURITY_POLICY_SSL_CHECK** checks whether your Classic Load Balancer SSL listeners are using a predefined policy. |
| **2.4**  | *Data at Rest*: Cloud native functionality protecting the confidentiality, authenticity and integrity of data at rest must be implemented. | **ENCRYPTED_VOLUMES** checks whether EBS volumes that are in an attached state are encrypted.<br/>**RDS_STORAGE_ENCRYPTED** checks whether storage encryption is enabled for your RDS DB instances.<br />**REDSHIFT_CLUSTER_CONFIGURATION_CHECK** checks whether Amazon Redshift clusters have the specified settings, including database encryption. |
| **3.1**  | *Information System Boundaries*: A native collection of solutions shall be selected to provide information system boundaries for information services, users, and information systems to prevent information leakage and unauthorized access. | **S3_BUCKET_PUBLIC_READ_PROHIBITED** checks that S3 buckets do not allow public read access.<br/>**S3_BUCKET_PUBLIC_WRITE_PROHIBITED** checks that your S3 buckets do not allow public write access.<br/> **LAMBDA_FUNCTION_PUBLIC_ACCESS_PROHIBITED** checks whether the Lambda function policy prohibits public access.<br/>**FMS_WEBACL_RULEGROUP_ASSOCIATION_CHECK** checks whether the RuleGroupId and WafOverrideAction pairs are associated with the WebACL at highest priority. <br/>**INSTANCES_IN_VPC** checks whether your EC2 instances belong to a virtual private cloud (VPC).<br/> **ATTACHED_INTERNET_GATEWAY_CHECK** checks if a VPC has an Internet Gateway attached. <br/> **OPEN_SECURITY_GROUP_CHECK** checks if a Security Group has any open ingress/egress ports. |
| **3.2**  | *Role-Base Access Control(RBAC)*: Groups of information services, users, and information systems shall be isolated logically and virtually to prevent information leakage and unauthorized access. | IAM controls in AWS are used to provide service and human accounts with the minimum necessary privileges to perform their function, in their respective AWS account(s). This is provided through SSO federation with on-prem AD. During account creation IAM roles are created and synced with on-prem to provide users with initial RBAC configuration.<br />**IAM_POLICY_BLACKLISTED_CHECK** checks that none of your IAM users, groups, or roles (excluding exceptionList) have the specified policies attached.<br />**IAM_PASSWORD_POLICY** checks whether the account password policy for IAM users meets the specified requirements. |
| **3.3**  | *Encrypted Channels*: Native functionality providing virtual boundaries shall be implement to support confidentiality and integrity of information in transit. | See policies in requirement 2.3                              |
| **4.1**  | *Federated*: Native functionality supporting federation of identities and access rights from UHG/Optum user directories shall exist to support Single Sign-on (SSO) of privileged  human and non-human users, services and computing devices preventing credential abuse. | Federation to AWS exists <br /><br />See requirement 3.2     |
| **4.2**  | *Direct Access*: Native functionality shall exist supporting multi-factor authentication of human and non-human users, services and computing devices preventing credential abuse. | **ROOT_ACCOUNT_MFA_ENABLED** checks whether the root user of your AWS account requires multi-factor authentication for console sign-in. |
| **5.2**  | *Externally-facing Information Systems*: Functionality ensuring confidentiality, integrity and availability of externally-facing information systems shall exist preventing exploitation technical security weaknesses. | AWS Config policies check the configuration of EC2 instances for certain vulnerabilities. <br /><br />**EC2_MANAGEDINSTANCE_INVENTORY_BLACKLISTED** checks whether instances managed by Amazon EC2 Systems Manager are configured to collect blacklisted inventory types. <br />**EC2_INSTANCE_DETAILED_MONITORING_ENABLED** checks whether detailed monitoring is enabled for EC2 instances. <br />**S3_BUCKET_LOGGING_ENABLED** checks whether logging is enabled for your S3 buckets. <br />**CLOUDWATCH_ALARM_SETTINGS_CHECK** checks whether CloudWatch alarms with the given metric name have the specified settings.  <br />**CLOUD_TRAIL_ENABLED** checks whether AWS CloudTrail is enabled in your AWS account. |
| **5.3**  | *Internal information Systems*: Functionality ensuring confidentiality, integrity and availability  of internal information systems shall exist preventing exploitation technical security weaknesses. | See policies in requirement 5.2                              |
| **5.4**  | *Patch Management*: Native functionality providing patching of information system flaws shall exist to protect against known security vulnerabilities and exploits-the-wild. | **EC2_INSTANCE_DETAILED_MONITORING_ENABLED** checks whether detailed monitoring is enabled for EC2 instances.<br /><br />There is no policy to validate applied patches. |
| **7.1**  | *Defense in Depth*: Native functionality shall be deployed in a tiered architecture model to protect ingress and egress perimeter routes against blended threats. | **INSTANCES_IN_VPC** checks whether your EC2 instances belong to a virtual private cloud (VPC). <br />**INCOMING_SSH_DISABLED** checks whether security groups that are in use disallow unrestricted incoming SSH traffic. <br />**RESTRICTED_INCOMING_TRAFFIC** checks whether security groups that are in use disallow unrestricted incoming TCP traffic to the specified ports. Currently monitoring ports TCP 22, 3389, 3306 and 1433<br/> **OPEN_SECURITY_GROUP_CHECK** checks if a Security Group has any open ingress/egress ports. |
| **7.2**  | *Isolation Stack*: Native functionality providing segregation, segmentation and isolation. | **INSTANCES_IN_VPC**<br/>checks whether your EC2 instances belong to a virtual private cloud (VPC). <br/> **S3_BUCKET_SSL_REQUESTS_ONLY** checks whether S3 buckets have policies that require requests to use Secure Socket Layer (SSL).  <br />**EIP_ATTACHED** checks whether all EIP addresses allocated to a VPC are attached to EC2 instances or in-use ENIs. <br/> **ATTACHED_INTERNET_GATEWAY_CHECK** checks if a VPC has an Internet Gateway attached. <br/> **OPEN_SECURITY_GROUP_CHECK** checks if a Security Group has any open ingress/egress ports. |
| **8.1**  | *DevOps*: Functionality must exist to capture security events at the software level when custom code is created. | AWS Launchpad works by configuring the [CloudTrail](https://aws.amazon.com/cloudtrail/) and [Config](https://aws.amazon.com/config/) services to send logs to S3 buckets in a Central Management Account. The logs are then forwarded to Splunk for Enterprise Information Security monitoring.<br />**CLOUD_TRAIL_ENABLED** checks whether AWS CloudTrail is enabled in your AWS account. <br />**S3_BUCKET_LOGGING_ENABLED** checks whether logging is enabled for S3 buckets.|
| **8.2**  | *Platform and Software Levels*: Cloud native functionality must be enabled to capture security events. | See policies in requirement 8.1 |
| **8.3**  | *Technology Stack hardware and software*: Native cloud functionality must be enabled to capture security events from the software, platform and infrastructure levels. | AWS Launchpad works by configuring the [CloudTrail](https://aws.amazon.com/cloudtrail/) and [Config](https://aws.amazon.com/config/) services to send logs to S3 buckets in a Central Management Account. AWS Config includes the following components: Config Recorder, Config Delivery Channel, and numerous Config Rules. The logs are then forwarded to Splunk for Enterprise Information Security monitoring. <br />No action is required on the user's end to run AWS Launchpad. This is done automatically by using a master account to assume the OrganizationAccountAccessRole that is under all of the underlying accounts. The OrganizationAccountAccessRole has AdminstratorAccess and its only Trusted Entity is the respective Master account. |
| **8.4**  | *Log Management*: Native cloud functionality must exist to manage logs to same level as Optum internal logs. | See policies in requirement 8.1<br />Please review [AWS documentation](<https://aws.amazon.com/documentation/cloudwatch/>) for detailed information about CloudWatch logs. |
| **9.2**  | *Security Incident Response*: Functionality must exist to monitor logs to support SIRC | See policies in requirement 8.1 - log data is sent to Splunk |
| **11.1** | *Authentication & Authorization*: A collection of native and traditional solutions shall be selected to manage access of human/non-human accounts, services, clients and host while enforcing the principle-of-least privilege along with  prevention of unauthorized access to information systems. | See policies in requirement 3.2                              |
| **11.2** | *User Directory Authentication*: Native and traditional user directories shall exist enabling authorized access and prevent unauthorized access to information systems. | See policies in requirement 3.2. <br />Federation is leveraging Optum's MSID directory. User access is controlled in Secure. |
| **11.3** | *Network-based Authentication*: Native, Commercial off the Shelf (COTS) and open-source shall exist enabling network-based authentication of subjects and objects and preventing unauthorized access to information systems. | Federation is leveraging Optum's MSID directory. User access is controlled in Secure. |
| **11.6** | *Authorization*: A collection of native and traditional solutions shall be selected to manage and grant access of subjects to objects while enforcing the principle-of-least privilege along with  prevention of unauthorized access to information systems. | See policies in requirement 3.2                              |
| **12.1** | *Data Protection*: A collection of native and traditional solutions shall be selected to protect data to prevent data tampering and reduce the possibility of unauthorized access by unauthorized persons. | See policies in requirement 3.1                              |
| **12.2** | *Databases*: Native features and third-party tools shall exist to control access to and information stored by databases. | **RDS_STORAGE_ENCRYPTED** checks whether storage encryption is enabled for RDS DB instances.<br />Access to RDS is controlled through [AWS IAM](https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/UsingWithRDS.IAM.html) |
| **12.3** | *Document Repositories*: Native and Commercial off the Shelf (COTS) shall exist enabling protection of documents/information stored at rest by information systems. | See policies in requirement 2.4                              |
| **12.4** | *Environments*: Native and Commercial off the Shelf (COTS) shall exist enabling protection of environments through established boundaries and preventing opportunistic and unauthorized access. | See policies in requirement 3.1                              |
| **12.7** | *Backup & Recovery*: Native and traditional mechanisms shall exist ensuring the maintenance, integrity, and availability of organizational information when events resulting in data loss occurs. | **DB_INSTANCE_BACKUP_ENABLED** checks whether RDS DB instances have backups enabled. Optionally, the rule checks the backup retention period and the backup window.<br/>|
| **13.2** | *Operating Systems*: Cloud native and traditional software shall be configured protect operating system software against accidental or malicious events. | **EC2_INSTANCE_DETAILED_MONITORING_ENABLED** checks whether detailed monitoring is enabled for EC2 instances. |



Requirements not satisfied by AWS Launchpad: 

| Req ID   | Requirement                                                  |                                                              |
| -------- | ------------------------------------------------------------ | ------------------------------------------------------------ |
| **2.2**  | *key management*: Optum Technology will manage keys and certificates associated with encryption. Storage at Optum technology data centers or on approved hardware service modules required. Auditing of all key management activities required. | Requirement not handled by AWS launchpad                     |
| **4.3**  | *Channel/Session Access*: Functionality shall exist to enable secure channel/session access to off-prem cloud providers by human and non-human, services and computing devices. | Requirement not handled by AWS launchpad                     |
| **5.1**  | *Secure Coding*: Functionality ensuring confidentiality, integrity and availability of custom applications developed by UHG/Optum shall exist preventing exploitation of prevailing coding vulnerabilities. | Requirement not handled by AWS launchpad, handled by application teams |
| **5.5**  | *Malicious and Mobile Code Protection*: Native functionality preventing execution of malicious code shall exist preventing compromise of information systems by manual or automated attacks. | Requirement not handled by AWS launchpad                     |
| **5.6**  | *Vulnerability Scanning Logs*: Native functionality shall exist enabling capture of attack surface management (ASM) results to UHG/Optum's EIS-approved repository. | Requirement not handled by AWS launchpad                     |
| **6.1**  | *Secure Configuration Baseline*: Functionality shall exist providing baseline security configurations for CSP environments. Assets instantiated in the cloud must adhere to enterprise standards, hardening guideline and compliance mandates. | Requirement not handled by AWS launchpad                     |
| **6.2**  | *CMDB*: Functionality shall exist enabling monitoring and remediation of configuration baselines of CSP environments. | Requirement not handled by AWS launchpad                     |
| **7.3**  | *DLP Stack*: Native functionality preventing the loss of data at rest or in transit. | Requirement not handled by AWS launchpad                     |
| **7.4**  | *DS/IPS Stack*: Native functionality enabling detection and alerting of intrusions or alerting and preventing intrusions. | Requirement not handled by AWS launchpad                     |
| **9.1**  | *Defense Monitoring*: Native functionality shall exist to supporting monitoring of on-prem logs by the Cyber Defense and SIR for investigative and incident handling purposes. | Requirement not handled by AWS launchpad. Commercial Cloud does not monitor on-prem logs. |
| **11.4** | *Role-Base Access Control (RBAC)*: Groups of information services, users, and information systems shall be isolated logically and virtually to prevent information leakage and unauthorized access. | Requirement not handled by AWS launchpad. Federation is leveraging Optum's MSID directory. User access is controlled in Secure. |
| **11.5** | *PKI-based authentication*: Native and traditional PKI mechanisms shall exist enabling entity authenticity, data integrity and information confidentiality. | Requirement not handled by AWS launchpad                     |
| **12.5** | *Mobile*: Native features and third-party tools shall exist to enabling the us of mobile devices while protecting UHG's/Optum's infrastructure against the abuse of mobile devices or the vulnerabilities they introduce. | Requirement not handled by AWS launchpad                     |
| **12.6** | *Media Handling*: Native and traditional  mechanisms shall exist ensuring appropriate handling of media  along with preventing unauthorized disclosure, modification, removal or destruction of information assets, or interruptions to business activities. | Requirement not handled by AWS launchpad                     |
| **12.8** | *Sanitization*: All items of equipment containing storage media shall be checked to ensure that any covered information and licensed software has been removed or securely overwritten prior to disposal. | Requirement not handled by AWS launchpad                     |
| **13.1** | *Application Protection*: A collection of administrative controls along with native and third party tools shall exist to reduce and prevent vulnerabilities associated with operational applications. | Requirement not handled by AWS launchpad - This control is required to be completed and demonstrated by the individual application teams |
| **13.4** | *Electronic Messaging*: A collection of cloud native and traditional tools shall be deployed to electronic messaging systems against compromise. | Requirement not handled by AWS launchpad                     |
| **13.5** | *Malware Protection*: Ensure information systems and supporting infrastructures is protected from malicious or unauthorized code. Protection against malicious code shall be based on malicious code detection and repair software, security awareness, and appropriate system access and change management controls. | Requirement not handled by AWS launchpad                     |
| **13.6** | *Patching*: To reduce the risks resulting from application coding flaws, vendor provided patches shall be applied. | Requirement not handled by AWS launchpad                     |
| **14.1** | Secure Coding: A collection of procedural practice along with native and third party tools shall exist to reduce vulnerabilities associated with custom code development. | Requirement not handled by AWS launchpad - This control is required to be completed and demonstrated by the individual application teams |
| **14.2** | *Secure Coding Practice*: Procedural documentation shall exist providing guidance promoting secure coding practices. | Requirement not handled by AWS launchpad - This control is required to be completed and demonstrated by the individual application teams |
| **14.3** | *Source Code Repositories*: Native, Commercial off the Shelf (COTS) or Open source solutions shall exist  enabling secure storage of code, libraries and APIs. | Requirement not handled by AWS launchpad - This control is required to be completed and demonstrated by the individual application teams |
| **14.4** | *Environments*: A collection of procedural practice along with cloud native and COTS technologies shall be implemented as part of defense-in-depth posture for secure coding. | Requirement not handled by AWS launchpad - This control is required to be completed and demonstrated by the individual application teams |
| **14.5** | *Threat Modeling*: Provide guidance to staff supporting custom software development understanding of required security controls. | Requirement not handled by AWS launchpad                     |
| **14.7** | *Legal and Contractual Considerations*: Appropriate administrative controls shall exist when third parties support custom coding on behalf of UHG/Optum. | Requirement not handled by AWS launchpad - This control is required to be completed and demonstrated by the individual application teams as needed |
